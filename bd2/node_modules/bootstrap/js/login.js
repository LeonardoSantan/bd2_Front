
document.addEventListener("DOMContentLoaded", function () {
  let switchCheckbox = document.getElementById("reg-log");
  let botaoLogin = document.getElementById("btn-login");
  let botaoRegistrar = document.getElementById("btn-registrar");

  function salvarDados() {
    if (switchCheckbox.checked) {
      // Card de registrar está ativo
      let nome = document.getElementById("register-name").value;
      let regemail = document.getElementById("register-email").value;
      let regpass = document.getElementById("register-password").value;

      localStorage.setItem("nome", nome);
      localStorage.setItem("regemail", regemail);
      localStorage.setItem("regpass", regpass);
    } else {
      // Card de login está ativo
      let logemail = document.getElementById("login-email").value;
      let logpass = document.getElementById("login-password").value;

      localStorage.setItem("logemail", logemail);
      localStorage.setItem("logpass", logpass);
    }
  }

  if (botaoLogin) {
    botaoLogin.addEventListener("click", function (ev) {
      ev.preventDefault();
      salvarDados();
      postLogin();
      // Aqui você pode redirecionar se necessário
    });
  }

  if (botaoRegistrar) {
    botaoRegistrar.addEventListener("click", function (ev) {
      ev.preventDefault();
      salvarDados();
      postRegister();
      // Aqui você pode redirecionar se necessário
    });
  }
});

function postRegister() {
  const url = "https://smsfranciscobeltrao.com.br";
  const urlRegister = `${url}/pessoa/`;

  const nome = localStorage.getItem("nome");
  const regemail = localStorage.getItem("regemail");
  const regpass = localStorage.getItem("regpass");

  localStorage.setItem("nome", nome);
  localStorage.setItem("regemail", regemail);
  localStorage.setItem("regpass", regpass);
  window.location.href = 'register.html';
}

function postLogin() {
  const url = "https://smsfranciscobeltrao.com.br";
  const urlLogin = `${url}/login/`;

  const logemail = localStorage.getItem("logemail");
  const logpass = localStorage.getItem("logpass");

  axios.post(urlLogin, {
    "user": logemail,
    "password": logpass
  })
    .then((response) => {
      const data = response.data;
      localStorage.setItem("id", data.codigo);
      window.location.href = 'main.html';
    })
    .catch(function (error) {
      console.error(error);
    });
}